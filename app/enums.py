"""Enums.

Copyright (c) 2025 MultiFactor
License: https://github.com/MultiDirectoryLab/MultiDirectory/blob/main/LICENSE
"""

from enum import IntEnum, StrEnum


class AceType(IntEnum):
    """ACE types."""

    CREATE_CHILD = 1
    READ = 2
    WRITE = 3
    DELETE = 4
    PASSWORD_MODIFY = 5


class RoleScope(IntEnum):
    """Scope of the role."""

    BASE_OBJECT = 0
    SINGLE_LEVEL = 1
    WHOLE_SUBTREE = 2


class MFAFlags(IntEnum):
    """Two-Factor auth action."""

    DISABLED = 0
    ENABLED = 1
    WHITELIST = 2


class MFAChallengeStatuses(StrEnum):
    """Two-Factor challenge status."""

    BYPASS = "bypass"
    PENDING = "pending"


class KindType(StrEnum):
    """Object kind types."""

    STRUCTURAL = "STRUCTURAL"
    ABSTRACT = "ABSTRACT"
    AUXILIARY = "AUXILIARY"


class AuditSeverity(IntEnum):
    """Audit policy severity."""

    EMERGENCY = 0
    ALERT = 1
    CRITICAL = 2
    ERROR = 3
    WARNING = 4
    NOTICE = 5
    INFO = 6
    DEBUG = 7


class AuditDestinationProtocolType(StrEnum):
    """Audit destination protocol type."""

    UDP = "udp"
    TCP = "tcp"


class AuditDestinationServiceType(StrEnum):
    """Audit destination type."""

    SYSLOG = "syslog"


class ErrorCode(IntEnum):
    """Internal error codes.

    Format: NNN NNN NN [http code] [context] [sequence number]
    """

    # Audit 001
    AUDIT_ALREADY_EXISTS = 40000101
    AUDIT_NOT_FOUND = 40000102

    # Auth 002
    AUTHENTICATION_ERROR = 40100201
    FORBIDDEN_ERROR = 40300202
    IDENTITY_ERROR = 40000203
    LOGIN_FAILED = 40100204
    MODIFY_FORBIDDEN = 40300205
    UNAUTHORIZED = 40100206

    # Database 003
    INTEGRITY_ERROR = 50000301

    # DNS 004
    DNS_CONNECTION_ERROR = 50000401
    DNS_ERROR = 50000402
    DNS_NOT_IMPLEMENTED = 50000403

    # General 005
    ALREADY_CONFIGURED = 40000501
    ATTRIBUTE_ERROR = 40000502
    CONNECTION_ABORTED = 50000503
    EXCEPTION = 50000504
    INVALID_CREDENTIALS = 40100505
    KRB_API_ERROR = 50000506
    KEY_ERROR = 40000507
    LOOKUP_ERROR = 40000508
    NO_VALID_DISTINGUISHED_NAME = 40000509
    NO_VALID_GROUPS = 40000510
    NOT_IMPLEMENTED = 50000511
    PERMISSION_ERROR = 40300512
    RECURSION_ERROR = 50000513
    RUNTIME_ERROR = 50000514
    SYSTEM_ERROR = 50000515
    TYPE_ERROR = 40000516
    USER_NOT_FOUND = 40000517
    VALIDATION_ERROR = 42200518
    VALUE_ERROR = 40000519

    # Kerberos 006
    KRB_API_ERROR_KERBEROS = 50000601
    KRB_API_PRINCIPAL_NOT_FOUND = 40000602
    KERBEROS_BASE_DN_NOT_FOUND = 40000603
    KERBEROS_CONFLICT = 40900604
    KERBEROS_DEPENDENCY = 42400605
    KERBEROS_ERROR = 50000606
    KERBEROS_NOT_FOUND = 40000607
    KERBEROS_UNAVAILABLE = 50300608
    KERBEROS_CHANGE_PASSWORD_ERROR = 50000609

    # LDAP 007
    ATTRIBUTE_TYPE_ALREADY_EXISTS = 40900701
    ATTRIBUTE_TYPE_CANT_MODIFY = 40300702
    ATTRIBUTE_TYPE_ERROR = 40000703
    ATTRIBUTE_TYPE_NOT_FOUND = 40000704
    ENTITY_TYPE_ALREADY_EXISTS = 40900705
    ENTITY_TYPE_CANT_MODIFY = 40300706
    ENTITY_TYPE_NOT_FOUND = 40000707
    ENTITY_TYPE_TYPE_ERROR = 40000708
    OBJECT_CLASS_ALREADY_EXISTS = 40900709
    OBJECT_CLASS_CANT_MODIFY = 40300710
    OBJECT_CLASS_NOT_FOUND = 40000711
    OBJECT_CLASS_TYPE_ERROR = 40000712

    # MFA 008
    MFA_ERROR = 40000801
    MFA_IDENTITY_ERROR = 40100802
    MFA_TOKEN_ERROR = 40000803
    MISSING_MFA_CREDENTIALS = 40000804
    MFA_CONNECT_ERROR = 50000805
    MFA_MISCONFIGURED = 50000806
    MULTIFACTOR_ERROR = 40000807

    # Network 009
    NETWORK_POLICY_ERROR = 40300901

    # Password 010
    PASSWORD_POLICY_ALREADY_EXISTS = 40901001
    PASSWORD_POLICY_BASE_ERROR = 40001002
    PASSWORD_POLICY_ERROR = 40001003
    PASSWORD_POLICY_NOT_FOUND = 40001004

    # Roles 011
    ACCESS_CONTROL_ENTRY_ADD = 40001101
    ACCESS_CONTROL_ENTRY_NOT_FOUND = 40001102
    ACCESS_CONTROL_ENTRY_UPDATE = 40001103
    ROLE_ERROR = 40001104
    ROLE_NOT_FOUND = 40001105

    # other
    UNHANDLED_ERROR = 50000001
    DATABASE_CONNECTION_ERROR = 50000101
    DATABASE_ERROR = 50000102
    SESSION_EXPIRED = 40100102
    BAD_REQUEST = 40000001
    ENTITY_NOT_FOUND = 40000101
    ENTITY_ALREADY_EXISTS = 40000102
    PERMISSION_DENIED = 40000201
    INVALID_OPERATION = 40000202
    PASSWORD_POLICY_VIOLATION = 42200101
    INVALID_INPUT = 42200201
