"""Modify LDAP schema.

Revision ID: b6cb962ecfac
Revises: 275222846605
Create Date: 2025-03-21 09:45:59.460969

"""

from alembic import op
from sqlalchemy.ext.asyncio import AsyncSession

from ldap_protocol.utils.raw_definition_parser import (
    RawDefinitionParser as RDParser,
)

# revision identifiers, used by Alembic.
revision = "b6cb962ecfac"
down_revision = "275222846605"
branch_labels = None
depends_on = None


def upgrade() -> None:
    """Upgrade."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_unique_constraint(None, "AttributeTypes", ["oid"])
    op.create_unique_constraint(None, "ObjectClasses", ["oid"])
    # ### end Alembic commands ###
    object_class_raws = (
        "( 2.5.6.9 NAME 'groupOfNames' SUP top STRUCTURAL MUST (cn $ member ) MAY (o $ ou $ businessCategory $ owner $ seeAlso $ reportToOriginator $ hideDLMembership $ oOFReplyToOriginator $ reportToOwner $ dLMemberRule ) )",
        "( 1.2.840.113556.1.5.15 NAME 'contact' SUP organizationalPerson STRUCTURAL MUST (cn ) MAY (notes $ msDS-SourceObjectDN $ msExchOriginatingForest $ msExchMasterAccountHistory ) )",
        "( 1.2.840.113556.1.3.46 NAME 'mailRecipient' SUP top AUXILIARY MUST (cn ) MAY (telephoneNumber $ userCertificate $ info $ department $ company $ garbageCollPeriod $ msExchAssistantName $ msExchLabeledURI $ versionNumber $ showInAddressBook $ userCert $ assistant $ legacyExchangeDN $ msDS-PhoneticDisplayName $ msDS-HABSeniorityIndex $ msDS-GeoCoordinatesAltitude $ msDS-GeoCoordinatesLatitude $ msDS-GeoCoordinatesLongitude $ msDS-ExternalDirectoryObjectId $ userSMIMECertificate $ textEncodedORAddress $ mail $ secretary $ labeledURI $ msExchRequireAuthToSendTo $ msExchMailboxFolderSet2 $ msExchRBACPolicyLink $ msExchMasterAccountSid $ msExchAuditAdmin $ msExchMailboxMoveRemoteHostName $ msExchRemoteRecipientType $ msExchResourceMetaData $ formData $ msExchRetentionComment $ msExchGroupMemberCount $ msExchResourceSearchProperties $ msExchWindowsLiveID $ msExchExpansionServerName $ msExchMailboxAuditLastAdminAccess $ dLMemSubmitPerms $ targetAddress $ autoReplyMessage $ msExchForeignGroupSID $ unauthOrig $ msExchGroupExternalMemberCount $ msExchModeratedByLink $ msExchResourceDisplay $ msExchProvisioningFlags $ msExchMessageHygieneSCLQuarantineThreshold $ msExchRecipientTypeDetails $ msExchCalendarRepairDisabled $ msExchResourceCapacity $ msExchSharingAnonymousIdentities $ msExchUMSpokenName $ msExchRetentionURL $ msExchUsageLocation $ msExchPreviousRecipientTypeDetails $ msExchSyncAccountsPolicyDN $ msExchUserAccountControl $ deliverAndRedirect $ msExchSignupAddresses $ altRecipientBL $ msExchAuditDelegate $ msExchMessageHygieneSCLJunkThreshold $ pOPContentFormat $ language $ msExchShadowWhenSoftDeletedTime $ publicDelegates $ languageCode $ msExchMailboxMoveTargetArchiveMDBLink $ msExchMailboxAuditLogAgeLimit $ msExchMailboxMoveTargetMDBLink $ msExchDirsyncSourceObjectClass $ msExchSendAsAddresses $ publicDelegatesBL $ dLMemDefault $ msExchRecipientSoftDeletedStatus $ delivExtContTypes $ enabledProtocols $ delivContLength $ msExchMailboxMoveFlags $ msExchAdministrativeUnitLink $ msExchWhenMailboxCreated $ msExchArbitrationMailbox $ dLMemRejectPerms $ msExchEdgeSyncRetryCount $ msExchFBURL $ msExchTransportRecipientSettingsFlags $ msExchSenderHintTranslations $ msExchPolicyEnabled $ msExchUMListInDirectorySearch $ msExchMailboxFolderSet $ msExchAggregationSubscriptionCredential $ msExchMailboxMoveTargetArchiveMDBLinkSL $ msExchMailboxPlanType $ msExchPoliciesIncluded $ msExchAuxMailboxParentObjectIdLink $ msExchMailboxMoveStatus $ msExchCoManagedObjectsBL $ msExchBypassModerationFromDLMembersLink $ msExchUMCallingLineIDs $ msExchObjectID $ msExchLicenseToken $ msExchRoleGroupType $ msExchPartnerGroupID $ msExchConfigurationXML $ folderPathname $ msExchMessageHygieneSCLDeleteThreshold $ msExchEnableModeration $ unauthOrigBL $ msExchLitigationHoldDate $ msExchLitigationHoldOwner $ msExchMultiMailboxDatabasesLink $ msExchSupervisionUserLink $ msExchAuditDelegateAdmin $ msExchHABShowInDepartments $ msExchMailboxMoveSourceArchiveMDBLinkSL $ msExchCapabilityIdentifiers $ protocolSettings $ internetEncoding $ msExchUMAddresses $ msExchSupervisionOneOffLink $ msExchMessageHygieneFlags $ msExchGroupSecurityFlags $ msExchWhenSoftDeletedTime $ msExchLocalizationFlags $ altRecipient $ msExchPublicFolderSmtpAddress $ authOrig $ mailNickname $ msExchProxyCustomProxy $ extensionData $ msExchOrganizationUpgradeStatus $ msExchUMRecipientDialPlanLink $ msExchPreviousAccountSid $ msExchModeratedObjectsBL $ msExchStsRefreshTokensValidFrom $ msExchBypassModerationLink $ msExchPolicyOptionList $ dLMemRejectPermsBL $ msExchMailboxSecurityDescriptor $ msExchImmutableId $ msExchParentPlanLink $ msExchUGMemberLink $ msExchThrottlingPolicyDN $ msExchMailboxMoveSourceMDBLink $ msExchSafeRecipientsHash $ pOPCharacterSet $ msExchEwsWellKnownApplicationPolicies $ msExchRecipLimit $ msExchUCVoiceMailSettings $ msExchMailboxAuditEnable $ msExchBypassModerationBL $ msExchOWAPolicy $ msExchMessageHygieneSCLRejectThreshold $ msExchExternalSyncState $ msExchEwsApplicationAccessPolicy $ replicationSensitivity $ deliveryMechanism $ msExchMailboxRelease $ forwardingAddress $ msExchGenericForwardingAddress $ msExchAuthPolicyLink $ expirationTime $ msExchAddressBookFlags $ submissionContLength $ msExchMailboxMoveSourceMDBLinkSL $ msExchMailboxMoveSourceArchiveMDBLink $ msExchBypassAudit $ msExchEwsExceptions $ msExchEwsEnabled $ msExchBlockedSendersHash $ msExchSharingPolicyLink $ importedFrom $ msExchArchiveRelease $ homeMTA $ msExchAuditOwner $ msExchMailboxAuditLastDelegateAccess $ msExchCalculatedTargetAddress $ msExchUGEventSubscriptionLink $ msExchCustomProxyAddresses $ dnQualifier $ msExchMailboxAuditLastExternalAccess $ msExchIntendedMailboxPlanLink $ msExchSupervisionDLLink $ msExchSafeSendersHash $ msExchRecipientDisplayType $ msExchMailboxMoveBatchName $ msExchSharingPartnerIdentities $ msExchInterruptUserOnAuditFailure $ msExchPublicFolderMailbox $ mAPIRecipient $ msExchPoliciesExcluded $ securityProtocol $ dLMemSubmitPermsBL $ msExchImmutableSid $ authOrigBL $ msExchMailboxMoveTargetMDBLinkSL $ msExchModerationFlags $ msExchBypassModerationFromDLMembersBL $ msExchOrganizationUpgradeRequest $ msExchRMSComputerAccountsLink $ msExchDirsyncID $ msExchTextMessagingState $ msExchUserHoldPolicies $ msExchHomeMTASL $ msExchUMDtmfMap ) )",
        "( 1.2.840.113556.1.3.23 NAME 'container' SUP top STRUCTURAL MUST (cn ) MAY (schemaVersion $ defaultClassStore $ msDS-ObjectReference $ msExchPolicyList $ x500RDN $ containerInfo $ msExchExportContainersBL $ msExchTemplateRDNs ) )",
        "( 1.2.840.113556.1.5.3 NAME 'samDomain' SUP top AUXILIARY MAY (description $ cACertificate $ builtinCreationTime $ builtinModifiedCount $ creationTime $ domainPolicyObject $ defaultLocalPolicyObject $ lockoutDuration $ lockOutObservationWindow $ lSACreationTime $ lSAModifiedCount $ lockoutThreshold $ maxPwdAge $ minPwdAge $ minPwdLength $ modifiedCountAtLastProm $ nETBIOSName $ nextRid $ pwdProperties $ pwdHistoryLength $ privateKey $ replicaSource $ controlAccessRights $ auditingPolicy $ eFSPolicy $ desktopProfile $ nTMixedDomain $ rIDManagerReference $ treeName $ pekList $ pekKeyChangeInterval $ gPLink $ gPOptions $ ms-DS-MachineAccountQuota $ msDS-LogonTimeSyncInterval $ msDS-PerUserTrustQuota $ msDS-AllUsersTrustQuota $ msDS-PerUserTrustTombstonesQuota $ msExchAddGroupsToToken ) )",
        "( 1.2.840.113556.1.5.147 NAME 'siteLink' SUP top STRUCTURAL MUST (siteList ) MAY (cost $ schedule $ options $ replInterval $ delivContLength $ msExchVersion $ msExchCost ) )",
        "( 1.2.840.113556.1.3.30 NAME 'computer' SUP user STRUCTURAL MAY (cn $ networkAddress $ localPolicyFlags $ defaultLocalPolicyObject $ machineRole $ location $ netbootInitialization $ netbootGUID $ netbootMachineFilePath $ siteGUID $ operatingSystem $ operatingSystemVersion $ operatingSystemServicePack $ operatingSystemHotfix $ volumeCount $ physicalLocationObject $ dNSHostName $ policyReplicationFlags $ managedBy $ rIDSetReferences $ catalogs $ netbootSIFFile $ netbootMirrorDataFile $ msDS-AdditionalDnsHostName $ msDS-AdditionalSamAccountName $ msDS-ExecuteScriptPassword $ msDS-KrbTgtLink $ msDS-RevealedUsers $ msDS-NeverRevealGroup $ msDS-RevealOnDemandGroup $ msDS-RevealedList $ msDS-AuthenticatedAtDC $ msDS-isGC $ msDS-isRODC $ msDS-SiteName $ msDS-PromotionSettings $ msTPM-OwnerInformation $ msTSProperty01 $ msTSProperty02 $ msDS-IsUserCachableAtRodc $ msDS-HostServiceAccount $ msTSEndpointData $ msTSEndpointType $ msTSEndpointPlugin $ msTSPrimaryDesktopBL $ msTSSecondaryDesktopBL $ msTPM-TpmInformationForComputer $ msDS-GenerationId $ msImaging-ThumbprintHash $ msImaging-HashAlgorithm $ netbootDUID $ msSFU30Name $ msSFU30Aliases $ msSFU30NisDomain $ nisMapName $ monitoringCachedViaRPC $ monitoredConfigurations $ msExchPolicyList $ monitoringAvailabilityWindow $ msExchComponentStates $ monitoredServices $ msExchExchangeServerLink $ monitoringMailUpdateUnits $ promoExpiration $ trackingLogPathName $ logRolloverInterval $ monitoringCachedViaMail $ msExchPolicyOptionList $ type $ monitoringRPCUpdateInterval $ monitoringRPCUpdateUnits $ monitoringMailUpdateInterval $ monitoringAvailabilityStyle $ securityProtocol ) )",
        "( 1.2.840.113556.1.5.17 NAME 'server' SUP top STRUCTURAL MAY (serialNumber $ networkAddress $ serverReference $ dNSHostName $ managedBy $ mailAddress $ bridgeheadTransportList $ msDS-isGC $ msDS-isRODC $ msDS-SiteName $ msDS-IsUserCachableAtRodc $ activationSchedule $ type $ activationStyle ) )",
        "( 1.2.840.113556.1.5.67 NAME 'domainDNS' SUP domain STRUCTURAL MAY (managedBy $ msDS-Behavior-Version $ msDS-AllowedDNSSuffixes $ msDS-USNLastSyncSuccess $ msDS-EnabledFeature $ msDS-ExpirePasswordsOnSmartCardOnlyAccounts $ msExchPolicyList ) )",
        "( 2.5.6.5 NAME 'organizationalUnit' SUP top STRUCTURAL MUST (ou ) MAY (c $ l $ st $ street $ searchGuide $ businessCategory $ postalAddress $ postalCode $ postOfficeBox $ physicalDeliveryOfficeName $ telephoneNumber $ telexNumber $ teletexTerminalIdentifier $ facsimileTelephoneNumber $ x121Address $ internationalISDNNumber $ registeredAddress $ destinationIndicator $ preferredDeliveryMethod $ seeAlso $ userPassword $ co $ countryCode $ desktopProfile $ defaultGroup $ managedBy $ uPNSuffixes $ gPLink $ gPOptions $ msCOM-UserPartitionSetLink $ thumbnailLogo $ msExchPolicyList ) )",
        "( 1.2.840.113556.1.5.8 NAME 'group' SUP top STRUCTURAL MUST (groupType ) MAY (member $ owner $ nTGroupMembers $ operatorCount $ adminCount $ groupAttributes $ groupMembershipSAM $ controlAccessRights $ location $ desktopProfile $ nonSecurityMember $ managedBy $ primaryGroupToken $ msDS-AzLDAPQuery $ msDS-NonMembers $ msDS-AzBizRule $ msDS-AzBizRuleLanguage $ msDS-AzLastImportedBizRulePath $ msDS-AzApplicationData $ msDS-PhoneticDisplayName $ msDS-AzObjectGuid $ msDS-AzGenericData $ msDS-HABSeniorityIndex $ msDS-PrimaryComputer $ mail $ thumbnailPhoto $ msSFU30Name $ msSFU30NisDomain $ msSFU30PosixMember $ msOrg-OtherDisplayNames $ msExchGroupJoinRestriction $ msOrg-GroupSubtypeName $ reportToOriginator $ msExchArbitrationMailbox $ hideDLMembership $ oOFReplyToOriginator $ msExchOriginatingForest $ reportToOwner $ msExchServerAdminDelegationBL $ msExchMasterAccountHistory $ msExchGroupDepartRestriction $ msExchCoManagedByLink $ dLMemberRule $ msOrg-Leaders $ msOrg-IsOrganizational ) )",
        "( 1.2.840.113556.1.5.125 NAME 'addressBookContainer' SUP top STRUCTURAL MUST (displayName ) MAY (purportedSearch $ msExchPurportedSearchUI $ msExchAddressListsBL $ msExchGlobalAddressListBL $ msExchMinAdminVersion $ msExchSystemAddressList $ msExchLastAppliedRecipientFilter $ msExchRecipientFilterFlags $ msExchAddressListOU $ msExchSearchBase $ msExchQueryFilterMetadata $ msExchQueryFilter $ msExchSearchScope $ msExchAllRoomListBL $ msExchEnableInternalEvaluator ) )",
        "( 2.5.6.0 NAME 'top'  ABSTRACT MUST (objectClass $ instanceType $ nTSecurityDescriptor $ objectCategory ) MAY (cn $ description $ distinguishedName $ whenCreated $ whenChanged $ subRefs $ displayName $ uSNCreated $ isDeleted $ dSASignature $ objectVersion $ repsTo $ repsFrom $ memberOf $ ownerBL $ uSNChanged $ uSNLastObjRem $ showInAdvancedViewOnly $ adminDisplayName $ proxyAddresses $ adminDescription $ extensionName $ uSNDSALastObjRemoved $ displayNamePrintable $ directReports $ wWWHomePage $ USNIntersite $ name $ objectGUID $ replPropertyMetaData $ replUpToDateVector $ flags $ revision $ wbemPath $ fSMORoleOwner $ systemFlags $ siteObjectBL $ serverReferenceBL $ nonSecurityMemberBL $ queryPolicyBL $ wellKnownObjects $ isPrivilegeHolder $ partialAttributeSet $ managedObjects $ partialAttributeDeletionList $ url $ lastKnownParent $ bridgeheadServerListBL $ netbootSCPBL $ isCriticalSystemObject $ frsComputerReferenceBL $ fRSMemberReferenceBL $ uSNSource $ fromEntry $ allowedChildClasses $ allowedChildClassesEffective $ allowedAttributes $ allowedAttributesEffective $ possibleInferiors $ canonicalName $ proxiedObjectName $ sDRightsEffective $ dSCorePropagationData $ otherWellKnownObjects $ mS-DS-ConsistencyGuid $ mS-DS-ConsistencyChildCount $ masteredBy $ msCOM-PartitionSetLink $ msCOM-UserLink $ msDS-Approx-Immed-Subordinates $ msDS-NCReplCursors $ msDS-NCReplInboundNeighbors $ msDS-NCReplOutboundNeighbors $ msDS-ReplAttributeMetaData $ msDS-ReplValueMetaData $ msDS-NonMembersBL $ msDS-MembersForAzRoleBL $ msDS-OperationsForAzTaskBL $ msDS-TasksForAzTaskBL $ msDS-OperationsForAzRoleBL $ msDS-TasksForAzRoleBL $ msDs-masteredBy $ msDS-ObjectReferenceBL $ msDS-PrincipalName $ msDS-RevealedDSAs $ msDS-KrbTgtLinkBl $ msDS-IsFullReplicaFor $ msDS-IsDomainFor $ msDS-IsPartialReplicaFor $ msDS-AuthenticatedToAccountlist $ msDS-NC-RO-Replica-Locations-BL $ msDS-RevealedListBL $ msDS-PSOApplied $ msDS-NcType $ msDS-OIDToGroupLinkBl $ msDS-HostServiceAccountBL $ isRecycled $ msDS-LocalEffectiveDeletionTime $ msDS-LocalEffectiveRecycleTime $ msDS-LastKnownRDN $ msDS-EnabledFeatureBL $ msDS-ClaimSharesPossibleValuesWithBL $ msDS-MembersOfResourcePropertyListBL $ msDS-IsPrimaryComputerFor $ msDS-ValueTypeReferenceBL $ msDS-TDOIngressBL $ msDS-TDOEgressBL $ msDS-parentdistname $ msDS-ReplValueMetaDataExt $ msds-memberOfTransitive $ msds-memberTransitive $ msDS-CloudAnchor $ msDS-SourceAnchor $ msDS-ObjectSoa $ structuralObjectClass $ createTimeStamp $ modifyTimeStamp $ subSchemaSubEntry $ msSFU30PosixMemberOf $ msDFSR-MemberReferenceBL $ msDFSR-ComputerReferenceBL $ msExchAssociatedAcceptedDomainBL $ msExchMobileRemoteDocumentsAllowedServersBL $ msExchEvictedMemebersBL $ msExchAvailabilityOrgWideAccountBL $ msExchAuxMailboxParentObjectIdBL $ msExchMobileRemoteDocumentsBlockedServersBL $ msExchDeviceAccessControlRuleBL $ msExchOWARemoteDocumentsAllowedServersBL $ msExchArchiveDatabaseBL $ msExchIntendedMailboxPlanBL $ msExchServerSiteBL $ msExchOWATranscodingFileTypesBL $ msExchUGMemberBL $ msExchOrganizationsTemplateRootsBL $ msExchTransportRuleTargetBL $ msExchDataEncryptionPolicyBL $ msExchOWAForceSaveFileTypesBL $ msExchHABRootDepartmentBL $ msExchAcceptedDomainBL $ msExchAccountForestBL $ msExchCatchAllRecipientBL $ msExchHygieneConfigurationMalwareBL $ msExchSupervisionOneOffBL $ msExchMailboxMoveTargetMDBBL $ msExchOrganizationsAddressBookRootsBL $ msExchMobileRemoteDocumentsInternalDomainSuffixListBL $ msExchParentPlanBL $ msOrg-LeadersBL $ msExchOWAForceSaveMIMETypesBL $ msExchMailboxMoveStorageMDBBL $ msExchMultiMailboxLocationsBL $ msExchMDBAvailabilityGroupConfigurationBL $ msExchOWATranscodingMimeTypesBL $ msExchTrustedDomainBL $ msExchOWABlockedMIMETypesBL $ msExchAuthPolicyBL $ msExchOrganizationsGlobalAddressListsBL $ msExchOABGeneratingMailboxBL $ msExchAvailabilityPerUserAccountBL $ msExchRMSComputerAccountsBL $ msExchMailboxMoveSourceMDBBL $ msExchHygieneConfigurationSpamBL $ msExchServerAssociationBL $ msExchMultiMailboxDatabasesBL $ msExchOWARemoteDocumentsInternalDomainSuffixListBL $ msExchSupervisionDLBL $ msExchMailboxMoveSourceArchiveMDBBL $ msExchOWAAllowedMimeTypesBL $ msExchOWAAllowedFileTypesBL $ msExchMailboxMoveTargetArchiveMDBBL $ msExchMailboxMoveSourceUserBL $ msExchSupervisionUserBL $ msExchRBACPolicyBL $ msExchUserBL $ msExchDelegateListBL $ msExchOWARemoteDocumentsBlockedServersBL $ msExchUGEventSubscriptionBL $ msExchSMTPReceiveDefaultAcceptedDomainBL $ msExchAdministrativeUnitBL $ msExchOWABlockedFileTypesBL $ msExchMailboxMoveTargetUserBL ) )",
        "( 2.5.6.7 NAME 'organizationalPerson' SUP person STRUCTURAL MAY (c $ l $ st $ street $ o $ ou $ title $ postalAddress $ postalCode $ postOfficeBox $ physicalDeliveryOfficeName $ telexNumber $ teletexTerminalIdentifier $ facsimileTelephoneNumber $ x121Address $ internationalISDNNumber $ registeredAddress $ destinationIndicator $ preferredDeliveryMethod $ givenName $ initials $ generationQualifier $ houseIdentifier $ otherTelephone $ otherPager $ co $ department $ company $ streetAddress $ otherHomePhone $ msExchHouseIdentifier $ employeeNumber $ employeeType $ personalTitle $ homePostalAddress $ countryCode $ employeeID $ comment $ division $ otherFacsimileTelephoneNumber $ otherMobile $ primaryTelexNumber $ primaryInternationalISDNNumber $ mhsORAddress $ otherMailbox $ assistant $ ipPhone $ otherIpPhone $ msDS-AllowedToDelegateTo $ msDS-PhoneticFirstName $ msDS-PhoneticLastName $ msDS-PhoneticDepartment $ msDS-PhoneticCompanyName $ msDS-PhoneticDisplayName $ msDS-HABSeniorityIndex $ msDS-AllowedToActOnBehalfOfOtherIdentity $ mail $ manager $ homePhone $ mobile $ pager $ middleName $ thumbnailPhoto $ thumbnailLogo $ telephoneAssistant $ personalPager $ msExchUserCulture $ businessRoles ) )",
        "( 1.2.840.113556.1.5.7000.47 NAME 'nTDSDSA' SUP applicationSettings STRUCTURAL MAY (hasMasterNCs $ hasPartialReplicaNCs $ dMDLocation $ invocationId $ networkAddress $ options $ fRSRootPath $ serverReference $ lastBackupRestorationTime $ queryPolicyObject $ managedBy $ retiredReplDSASignatures $ msDS-Behavior-Version $ msDS-HasInstantiatedNCs $ msDS-ReplicationEpoch $ msDS-HasDomainNCs $ msDS-RetiredReplNCSignatures $ msDS-hasMasterNCs $ msDS-RevealedUsers $ msDS-hasFullReplicaNCs $ msDS-NeverRevealGroup $ msDS-RevealOnDemandGroup $ msDS-isGC $ msDS-isRODC $ msDS-SiteName $ msDS-IsUserCachableAtRodc $ msDS-EnabledFeature $ deliveryMechanism $ diagnosticRegKey ) )",
        "( 1.2.840.113556.1.5.31 NAME 'site' SUP top STRUCTURAL MAY (location $ notificationList $ managedBy $ gPLink $ gPOptions $ mSMQSiteID $ mSMQNt4Stub $ mSMQSiteForeign $ mSMQInterval1 $ mSMQInterval2 $ msDS-BridgeHeadServersUsed $ msExchMCUHostsSitesBL $ msExchPartnerId $ msExchTransportSiteFlags $ msExchConferenceZoneBL $ msExchResponsibleForSites $ msExchVersion $ msExchMinorPartnerId ) )",
        "( 1.2.840.113556.1.5.6 NAME 'securityPrincipal' SUP top AUXILIARY MUST (objectSid $ sAMAccountName ) MAY (nTSecurityDescriptor $ securityIdentifier $ supplementalCredentials $ rid $ sAMAccountType $ sIDHistory $ altSecurityIdentities $ tokenGroups $ tokenGroupsNoGCAcceptable $ accountNameHistory $ tokenGroupsGlobalAndUniversal $ msDS-KeyVersionNumber $ msds-tokenGroupNames $ msds-tokenGroupNamesGlobalAndUniversal $ msds-tokenGroupNamesNoGCAcceptable ) )",
        "( 2.5.6.13 NAME 'dSA' SUP applicationEntity STRUCTURAL MAY (knowledgeInformation $ fileVersion ) )",
        "( 1.2.840.113556.1.5.9 NAME 'user' SUP organizationalPerson STRUCTURAL MAY (o $ businessCategory $ userCertificate $ givenName $ initials $ x500uniqueIdentifier $ displayName $ networkAddress $ employeeNumber $ employeeType $ homePostalAddress $ userAccountControl $ badPwdCount $ codePage $ homeDirectory $ homeDrive $ badPasswordTime $ lastLogoff $ lastLogon $ dBCSPwd $ localeID $ scriptPath $ logonHours $ logonWorkstation $ maxStorage $ userWorkstations $ unicodePwd $ otherLoginWorkstations $ ntPwdHistory $ pwdLastSet $ preferredOU $ primaryGroupID $ userParameters $ profilePath $ operatorCount $ adminCount $ accountExpires $ lmPwdHistory $ groupMembershipSAM $ logonCount $ controlAccessRights $ defaultClassStore $ groupsToIgnore $ groupPriority $ desktopProfile $ dynamicLDAPServer $ userPrincipalName $ lockoutTime $ userSharedFolder $ userSharedFolderOther $ servicePrincipalName $ aCSPolicyName $ terminalServer $ mSMQSignCertificates $ mSMQDigests $ mSMQDigestsMig $ mSMQSignCertificatesMig $ msNPAllowDialin $ msNPCallingStationID $ msNPSavedCallingStationID $ msRADIUSCallbackNumber $ msRADIUSFramedIPAddress $ msRADIUSFramedRoute $ msRADIUSServiceType $ msRASSavedCallbackNumber $ msRASSavedFramedIPAddress $ msRASSavedFramedRoute $ mS-DS-CreatorSID $ msCOM-UserPartitionSetLink $ msDS-Cached-Membership $ msDS-Cached-Membership-Time-Stamp $ msDS-Site-Affinity $ msDS-User-Account-Control-Computed $ lastLogonTimestamp $ msIIS-FTPRoot $ msIIS-FTPDir $ msDRM-IdentityCertificate $ msDS-SourceObjectDN $ msPKIRoamingTimeStamp $ msPKIDPAPIMasterKeys $ msPKIAccountCredentials $ msRADIUS-FramedInterfaceId $ msRADIUS-SavedFramedInterfaceId $ msRADIUS-FramedIpv6Prefix $ msRADIUS-SavedFramedIpv6Prefix $ msRADIUS-FramedIpv6Route $ msRADIUS-SavedFramedIpv6Route $ msDS-SecondaryKrbTgtNumber $ msDS-AuthenticatedAtDC $ msDS-SupportedEncryptionTypes $ msDS-LastSuccessfulInteractiveLogonTime $ msDS-LastFailedInteractiveLogonTime $ msDS-FailedInteractiveLogonCount $ msDS-FailedInteractiveLogonCountAtLastSuccessfulLogon $ msTSProfilePath $ msTSHomeDirectory $ msTSHomeDrive $ msTSAllowLogon $ msTSRemoteControl $ msTSMaxDisconnectionTime $ msTSMaxConnectionTime $ msTSMaxIdleTime $ msTSReconnectionAction $ msTSBrokenConnectionAction $ msTSConnectClientDrives $ msTSConnectPrinterDrives $ msTSDefaultToMainPrinter $ msTSWorkDirectory $ msTSInitialProgram $ msTSProperty01 $ msTSProperty02 $ msTSExpireDate $ msTSLicenseVersion $ msTSManagingLS $ msDS-UserPasswordExpiryTimeComputed $ msTSExpireDate2 $ msTSLicenseVersion2 $ msTSManagingLS2 $ msTSExpireDate3 $ msTSLicenseVersion3 $ msTSManagingLS3 $ msTSExpireDate4 $ msTSLicenseVersion4 $ msTSManagingLS4 $ msTSLSProperty01 $ msTSLSProperty02 $ msDS-ResultantPSO $ msPKI-CredentialRoamingTokens $ msTSPrimaryDesktop $ msTSSecondaryDesktops $ msDS-PrimaryComputer $ msDS-SyncServerUrl $ msDS-AssignedAuthNPolicySilo $ msDS-AuthNPolicySiloMembersBL $ msDS-AssignedAuthNPolicy $ msDS-KeyPrincipalBL $ msDS-KeyCredentialLink $ userSMIMECertificate $ uid $ mail $ roomNumber $ photo $ manager $ homePhone $ secretary $ mobile $ pager $ audio $ jpegPhoto $ carLicense $ departmentNumber $ preferredLanguage $ userPKCS12 $ labeledURI $ msSFU30Name $ msSFU30NisDomain $ kMServer $ msExchControllingZone $ msExchConferenceMailboxBL $ msExchOriginatingForest $ msExchQueryBaseDN $ msExchResourceProperties $ msExchIMAPOWAURLPrefixOverride $ msExchResourceGUID ) )",
    )

    async def _modify_object_classes(connection):
        session = AsyncSession(bind=connection)
        await session.begin()

        for object_class_raw in object_class_raws:
            object_class = await RDParser.create_object_class_by_raw(
                session=session,
                raw_definition=object_class_raw,
            )
            object_class.is_system = True
        await session.commit()

    op.run_async(_modify_object_classes)


def downgrade() -> None:
    """Downgrade."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, "ObjectClasses", type_="unique")
    op.drop_constraint(None, "AttributeTypes", type_="unique")
    # ### end Alembic commands ###
