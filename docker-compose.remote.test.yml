version: "3.7"

services:
  md-test:
    image: ${TAG}
    restart: "no"
    volumes:
      - ./app:/app
      - ./tests:/app/tests
    environment:
      DEBUG: 1
      POSTGRES_USER: user1
      POSTGRES_PASSWORD: password123
      SECRET_KEY: 6a0452ae20cab4e21b6e9d18fa4b7bf397dd66ec3968b2d7407694278fd84cce
    command: bash -c "python -m pytest -W ignore::DeprecationWarning -vv"

  postgres:
    image: postgres:16
    restart: "no"
    environment:
      POSTGRES_USER: user1
      POSTGRES_PASSWORD: password123
    expose:
      - "5432"
    logging:
      driver: "none"
